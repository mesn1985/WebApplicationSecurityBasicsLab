# Broken Object Level Authorization and Excessive Data Exposure

### 🎯 Objective
Understand how Broken Object Level Authorization (BOLA) and Excessive Data Exposure vulnerabilities manifest in APIs.  
Learn how these issues can be exploited individually — and in combination — to access unauthorized data.
  
Multiple vulnerabilities often interact in ways that lead to full system compromise.  
In this lab, you will explore two common API vulnerabilities — BOLA and Excessive Data Exposure — and see how they can be combined to leak sensitive information.
  

## 1 – BOLA Using Object IDs Without Authorization

The purpose of this exercise is to provide a basic understanding of how a BOLA (Broken Object Level Authorization) vulnerability can appear in practice.

Follow these steps:

1. Create two user accounts — we’ll refer to them as **User A** and **User B**.
2. Register a vehicle for each user. You’ll receive a **VIN number** and **PIN code** in the welcome email via MailHog.
3. While authenticated as User A, navigate to the vehicle details dashboard.
4. Use **Burp Suite** to intercept the request made to retrieve the vehicle data.
5. Note the **resource ID** (e.g., vehicle ID) used in the request.
6. Log out, then authenticate as User B.
7. Navigate to the same dashboard and capture the equivalent vehicle data request using Burp Suite.
8. Send User B’s request to the [Repeater](https://portswigger.net/burp/documentation/desktop/tools/repeater).
9. In Repeater, replace User B’s resource ID with the one you captured from User A.
10. Send the modified request.

✅ If the server returns **User A’s vehicle data** while authenticated as User B, you have successfully demonstrated a **BOLA** vulnerability.

_This technique of trying cross-user access is commonly referred to as **A/B testing** in security assessments._

🔐 This type of vulnerability is classified as **Broken Object Level Authorization (BOLA)** — also known as **Insecure Direct Object Reference (IDOR)**.


---

## 2 – Excessive Data Exposure

The purpose of this exercise is to identify cases where API responses include more data than they should expose.

Explore the application and inspect API responses using a proxy tool like Burp Suite. Consider the following:

- Can you find API responses that return **more information than is displayed** in the user interface?
- Do responses include sensitive fields such as internal user IDs, email addresses, roles, or tokens?
- For example, does a **vehicle data endpoint** expose fields not shown in the dashboard?

Excessive data exposure is often the result of returning full database objects to the frontend, relying on the client to filter what's shown.  
This practice can unintentionally leak sensitive information.
  
---

## 3 – Explore OWASP Application Security Verification Standard

OWASP’s [Application Security Verification Standard 5(ASVS)](https://github.com/OWASP/ASVS/tree/v5.0.0?tab=readme-ov-file#latest-stable-version---500) outlines controls and tests for secure software design.

Review the standard and consider:

- Which section(s) cover access control?
- Are BOLA/IDOR vulnerabilities mentioned directly?
- What testing strategies or verification requirements does ASVS recommend for access control?

---

## 4 – Access Other Users’ Mechanic Reports

There is a BOLA vulnerability that allows one authenticated user to view another user’s mechanic report.

Your task:  
Use Burp Suite to analyze requests related to **vehicle maintenance or mechanic history**.

- What kind of identifier is used to retrieve mechanic reports?
- Can you modify the identifier to access another user’s report?
- What should the server be doing to prevent this?

If you’re successful, you’ll demonstrate another example of BOLA — this time involving more sensitive user data.
  
> ## 5 🧠 Reflect
> 1. **What did you discover, and why did it work?**  
>    Reflect on the vulnerability’s nature and the conditions that allowed exploitation.
> 2. **How might this vulnerability appear in real-world systems?**  
>    Consider where similar flaws might exist in production environments.
> 3. **How could you mitigate this?**  
>    Think about technical fixes, secure design patterns, and where to find guidance — such as the [OWASP ASVS](https://owasp.org/www-project-application-security-verification-standard/).
> 4. **How would you communicate this issue to a developer or stakeholder?**  
>    Practice explaining the risk, impact, and urgency in clear, actionable language.
>
> ---
>
> ## ⚖️ Ethical Reflection
> You simulated an attack that could lock users out or compromise accounts.  
> - In what ways could testing like this cause unintended harm if done on live systems? (For example, by abusing a user account) 
> - What **safeguards** must be in place when conducting such tests professionally?  
> - How can you ensure you have proper **authorization** before attempting such tests?
